grammar Pbxproj

  rule pbx_file_content
    (end_of_line_comment / c_comment / dictionary / whitespace)* <PbxProject>
  end

  rule end_of_line_comment
    '//' 
    (!crlf .)* 
    (crlf / !.) <PbxEndOfLineComment>
  end
  
  rule c_comment
    '/*' 
    ( 
      !'*/' 
      (. / crlf) 
    )* 
    '*/' <PbxComment>
  end
  
  rule dictionary
    '{' 
    (
      (whitespace* c_comment whitespace*)?
      assignment
      (whitespace* c_comment whitespace*)?
    )*
    whitespace* 
    '}' <PbxDictionary>
  end
  
  rule assignment
    whitespace* 
    value 
    whitespace* 
    c_comment? 
    whitespace* 
    '=' 
    whitespace* 
    (dictionary / array / value) 
    whitespace* 
    c_comment? 
    ';'
    whitespace* <PbxAssignment>
  end
  
  rule array
    '(' 
    whitespace* 
    ((value / dictionary) (whitespace* c_comment)? ',' whitespace*)* 
    whitespace* 
    ')' <PbxArray>
  end
  
  rule value
    literal / string
  end
  
  rule literal
    [a-zA-Z0-9_\.\/]+ <PbxLiteral>
  end
  
  rule string
    ["]
    ('\"' / !["] .)*
    ["] <PbxString>
  end
  
  rule whitespace
    [\s] / crlf
  end
    
  rule crlf 
    "\r\n" / "\n"
  end
end